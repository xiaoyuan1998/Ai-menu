"use strict";(()=>{var e={};e.id=495,e.ids=[495],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},7561:e=>{e.exports=require("node:fs")},4492:e=>{e.exports=require("node:stream")},2477:e=>{e.exports=require("node:stream/web")},1017:e=>{e.exports=require("path")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},1267:e=>{e.exports=require("worker_threads")},9796:e=>{e.exports=require("zlib")},4123:(e,t,n)=>{n.r(t),n.d(t,{headerHooks:()=>S,originalPathname:()=>_,patchFetch:()=>I,requestAsyncStorage:()=>x,routeModule:()=>b,serverHooks:()=>E,staticGenerationAsyncStorage:()=>U,staticGenerationBailout:()=>O});var r={};n.r(r),n.d(r,{POST:()=>w});var i=n(5419),o=n(9108),s=n(9678),a=n(8070),u=n(8188),c=n(6605);let l=require("fs/promises");var h=n(1017),d=n.n(h);let f=require("crypto");var p=n.n(f);let y={zh:{system:"你是一个专业的美食图片生成专家。请直接输出简洁的图片描述，不要包含任何对话、解释或markdown格式的内容。描述应该专注于视觉细节，以便AI生成精美的美食图片。",user:e=>`生成一张${e}的图片描述。要求：1. 专业的美食摄影构图 2. 精致的摆盘和装饰 3. 突出食材的质地和色泽 4. 适当的光影效果。请直接描述图片内容，不要加入任何其他文字。`},fr:{system:"Vous \xeates un expert en photographie culinaire. Fournissez uniquement une description visuelle directe, sans dialogue ni format markdown. Concentrez-vous sur les d\xe9tails visuels pour la g\xe9n\xe9ration d'images.",user:e=>`Description pour une photo de ${e}. Crit\xe8res : 1. Composition photographique professionnelle 2. Pr\xe9sentation \xe9l\xe9gante 3. Textures et couleurs des ingr\xe9dients 4. Effets de lumi\xe8re appropri\xe9s. D\xe9crivez uniquement le contenu visuel.`},it:{system:"Sei un esperto di fotografia culinaria. Fornisci solo una descrizione visiva diretta, senza dialoghi o formato markdown. Concentrati sui dettagli visivi per la generazione delle immagini.",user:e=>`Descrizione per una foto di ${e}. Criteri: 1. Composizione fotografica professionale 2. Presentazione elegante 3. Texture e colori degli ingredienti 4. Effetti di luce appropriati. Descrivi solo il contenuto visivo.`},"en-us":{system:"You are a professional food photography expert. Provide direct visual descriptions without any dialogue or markdown formatting. Focus on visual details for AI image generation.",user:e=>`Create a description for ${e}. Requirements: 1. Professional food photography composition 2. Elegant plating and garnishing 3. Highlight ingredient textures and colors 4. Appropriate lighting effects. Describe only the visual content.`}},g=e=>y[e]||y["en-us"],v=new u.ZP({baseURL:"https://openrouter.ai/api/v1",apiKey:process.env.OPENROUTER_API_KEY,defaultHeaders:{"HTTP-Referer":process.env.APP_URL||"http://localhost:3000","X-Title":"AI-Menu-Generator"}});async function m(e){console.log("Generating image with prompt:",e);try{let t=await c.fal.subscribe("fal-ai/fast-sdxl",{input:{prompt:e,negative_prompt:"blurry, bad quality, distorted, deformed",num_inference_steps:50,guidance_scale:7.5,image_size:{width:1024,height:1024}},pollInterval:1e3,logs:!0});return console.log("Fal.AI API response:",JSON.stringify(t,null,2)),{images:[{url:t.data.images[0].url,seed:t.data.seed,mimeType:t.data.images[0].content_type||"image/jpeg"}],model:"fast-sdxl",prompt:e}}catch(e){if(console.error("Error in image generation:",e),e?.body?.detail?.includes("Exhausted balance"))throw Error("Image generation service is temporarily unavailable due to API limits. Please try again later.");throw Error(`Failed to generate image: ${e.message||"Unknown error"}`)}}async function w(e){console.log("Starting POST request processing");let t=Date.now();try{console.log("Reading request body");let{name:n,language:r="en-us"}=await e.json();if(console.log("Request body:",{name:n,language:r}),!n)return console.log("Error: No dish name provided"),a.Z.json({error:"No dish name provided"},{status:400});let i=g(r);console.log("Step 1: Generating description for:",n);let o=await v.chat.completions.create({model:"openai/gpt-3.5-turbo",messages:[{role:"system",content:i.system},{role:"user",content:i.user(n)}],temperature:.7,max_tokens:500});console.log("Step 2: Processing description response"),console.log("Description response:",JSON.stringify(o,null,2));let s=(o.choices?.[0]?.message?.content||"").replace(/!\[.*?\]\(.*?\)/g,"").replace(/```.*?```/gs,"").replace(/\[.*?\]/g,"").replace(/https?:\/\/\S+/g,"").replace(/\n+/g," ").trim(),u=`A professional food photograph of ${s}. Shot with a high-end DSLR camera, using natural lighting, shallow depth of field (f/2.8), and styled for a luxury restaurant menu. 8K resolution, hyperrealistic details, professional food photography composition.`;console.log("Step 3: Creating final prompt"),console.log("Final prompt:",u),console.log("Step 4: Generating image");let c=await m(u);console.log("Image generation result:",JSON.stringify(c,null,2)),console.log("Step 5: Saving image to disk");let h=`${p().randomBytes(16).toString("hex")}.jpg`,f=d().join(process.cwd(),"public","generated-images",h);if(console.log("Image result structure:",{hasImages:!!c.images,imageKeys:Object.keys(c),firstImage:c.images?.[0]}),!c.images?.[0]?.url)throw Error("Invalid image result structure: "+JSON.stringify(c));let y=c.images[0].url,w=await fetch(y),b=await w.arrayBuffer();await (0,l.writeFile)(f,Buffer.from(b)),console.log("Step 6: Preparing response"),console.log("Time elapsed:",Date.now()-t,"ms");let x={...c,imageUrl:`/generated-images/${h}`,model:"flux-pro-v1.1-ultra",generationTime:Date.now()-t};console.log("Final response data:",JSON.stringify(x,null,2));let U=a.Z.json(x);return console.log("Response headers:",Object.fromEntries(U.headers.entries())),console.log("Step 7: Sending response"),U}catch(r){console.error("Error in request processing:",r),console.error("Error stack:",r.stack),console.log("Time elapsed before error:",Date.now()-t,"ms");let e="Error in image generation process",n=500;return r.message.includes("API limits")&&(e=r.message,n=503),a.Z.json({error:e,details:r.message,timestamp:new Date().toISOString(),processingTime:Date.now()-t},{status:n,headers:{"Content-Type":"application/json"}})}}c.fal.config({credentials:process.env.FAL_API_KEY});let b=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/generate-image/route",pathname:"/api/generate-image",filename:"route",bundlePath:"app/api/generate-image/route"},resolvedPagePath:"C:\\Users\\1989c\\Downloads\\ai-menu-generator\\ai-menu-generator\\app\\api\\generate-image\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:x,staticGenerationAsyncStorage:U,serverHooks:E,headerHooks:S,staticGenerationBailout:O}=b,_="/api/generate-image/route";function I(){return(0,s.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:U})}},8008:(e,t)=>{function n(e){return{enumerable:!0,value:e}}function r(e){return{enumerable:!0,writable:!0,value:e}}Object.defineProperty(t,"__esModule",{value:!0});let i={},o=()=>!0,s=()=>({}),a=e=>e,u=(e,t,n,r)=>e.apply(n,r)&&t.apply(n,r),c=(e,t,n,[r,i])=>t.call(n,e.call(n,r,i),i),l=(e,t)=>Object.freeze(Object.create(e,t));function h(e,t,n){return e.reduce((e,t)=>function(...r){return n(e,t,this,r)},t)}function d(e){return l(this,{fn:n(e)})}let f={},p=d.bind(f),y={},g=d.bind(y);function v(e,t){return t.filter(t=>e.isPrototypeOf(t))}function m(e,t,...r){let i=h(v(y,r).map(e=>e.fn),o,u),s=h(v(f,r).map(e=>e.fn),a,c);return l(this,{from:n(e),to:n(t),guards:n(i),reducers:n(s)})}let w={},b={},x=m.bind(w),U=m.bind(b,null);function E(e,t,n){return P(t,e,n,this.immediates)||e}function S(e){let t=new Map;for(let n of e)t.has(n.from)||t.set(n.from,[]),t.get(n.from).push(n);return t}let O={enter:a},_={enter(e,t,r){let i=this.fn.call(t,t.context,r);return A.isPrototypeOf(i)?l(I,{machine:n(i),transitions:n(this.transitions)}).enter(e,t,r):(i.then(e=>t.send({type:"done",data:e})).catch(e=>t.send({type:"error",error:e})),e)}},I={enter(e,t,n){if(t.child=T(this.machine,e=>{t.onChange(e),t.child==e&&e.machine.state.value.final&&(delete t.child,t.send({type:"done",data:e.context}))},t.context,n),t.child.machine.state.value.final){let n=t.child.context;return delete t.child,P(t,e,{type:"done",data:n},this.transitions.get("done"))}return e}},A={get state(){return{name:this.current,value:this.states[this.current]}}};function P(e,t,r,o){let{context:s}=e;for(let{to:a,guards:u,reducers:c}of o)if(u(s,r)){e.context=c.call(e,s,r);let o=t.original||t,u=l(o,{current:n(a),original:{value:o}});return i._onEnter&&i._onEnter(t,a,e.context,s,r),u.state.value.enter(u,e,r)}}let j={send(e){this.machine=function(e,t){let n=t.type||t,{machine:r}=e,{value:o,name:s}=r.state;return o.transitions.has(n)?P(e,r,t,o.transitions.get(n))||r:(i._send&&i._send(n,s),r)}(this,e),this.onChange(this)}};function T(e,t,i,o){let s=Object.create(j,{machine:r(e),context:r(e.context(i,o)),onChange:n(t)});return s.send=s.send.bind(s),s.machine=s.machine.state.value.enter(s.machine,s,o),s}t.action=e=>p((t,n)=>!!~e(t,n)&&t),t.createMachine=function(e,t,r=s){return"string"!=typeof e&&(r=t||s,e=Object.keys(t=e)[0]),i._create&&i._create(e,t),l(A,{context:n(r),current:n(e),states:n(t)})},t.d=i,t.guard=g,t.immediate=U,t.interpret=T,t.invoke=function(e,...t){let r=n(S(t));return A.isPrototypeOf(e)?l(I,{machine:n(e),transitions:r}):l(_,{fn:n(e),transitions:r})},t.reduce=p,t.state=function(...e){let t=v(w,e),r=v(b,e),i={final:n(0===e.length),transitions:n(S(t))};return r.length&&(i.immediates=n(r),i.enter=n(E)),l(O,i)},t.transition=x},5538:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});let n=[239,187,191];t.createParser=function(e){let t,r,i,o,s,a,u;return c(),{feed:function(c){var l;r=r?r+c:c,t&&(l=r,n.every((e,t)=>l.charCodeAt(t)===e))&&(r=r.slice(n.length)),t=!1;let h=r.length,d=0,f=!1;for(;d<h;){let t;f&&("\n"===r[d]&&++d,f=!1);let n=-1,c=o;for(let e=i;n<0&&e<h;++e)":"===(t=r[e])&&c<0?c=e-d:"\r"===t?(f=!0,n=e-d):"\n"===t&&(n=e-d);if(n<0){i=h-d,o=c;break}i=0,o=-1,function(t,n,r,i){if(0===i){u.length>0&&(e({type:"event",id:s,event:a||void 0,data:u.slice(0,-1)}),u="",s=void 0),a=void 0;return}let o=r<0,c=t.slice(n,n+(o?i:r)),l=0;l=o?i:" "===t[n+r+1]?r+2:r+1;let h=n+l,d=i-l,f=t.slice(h,h+d).toString();if("data"===c)u+=f?"".concat(f,"\n"):"\n";else if("event"===c)a=f;else if("id"!==c||f.includes("\x00")){if("retry"===c){let t=parseInt(f,10);Number.isNaN(t)||e({type:"reconnect-interval",value:t})}}else s=f}(r,d,c,n),d+=n+1}d===h?r="":d>0&&(r=r.slice(d))},reset:c};function c(){t=!0,r="",i=0,o=-1,s=void 0,a=void 0,u=""}}},5122:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TOKEN_EXPIRATION_SECONDS=void 0,t.getTemporaryAuthToken=function(e,n){return r(this,void 0,void 0,function*(){let r=(0,s.parseEndpointId)(e),a=yield(0,o.dispatchRequest)({method:"POST",targetUrl:`${(0,i.getRestApiUrl)()}/tokens/`,config:n,input:{allowed_apps:[r.alias],token_expiration:t.TOKEN_EXPIRATION_SECONDS}});return"string"!=typeof a&&a.detail?a.detail:a})};let i=n(8229),o=n(2283),s=n(4138);t.TOKEN_EXPIRATION_SECONDS=120},8926:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.createFalClient=function(e={}){let t=(0,i.createConfig)(e),n=(0,c.createStorageClient)({config:t}),h=(0,o.createQueueClient)({config:t,storage:n}),d=(0,l.createStreamingClient)({config:t,storage:n});return{queue:h,realtime:(0,s.createRealtimeClient)({config:t}),storage:n,streaming:d,stream:d.stream,run(e){return r(this,arguments,void 0,function*(e,r={}){let i=r.input?yield n.transformInput(r.input):void 0;return(0,a.dispatchRequest)({method:r.method,targetUrl:(0,a.buildUrl)(e,r),input:i,config:Object.assign(Object.assign({},t),{responseHandler:u.resultResponseHandler}),options:{signal:r.abortSignal}})})},subscribe:(e,t)=>r(this,void 0,void 0,function*(){let{request_id:n}=yield h.submit(e,t);return t.onEnqueue&&t.onEnqueue(n),yield h.subscribeToStatus(e,Object.assign({requestId:n},t)),h.result(e,{requestId:n})})}};let i=n(8229),o=n(2900),s=n(5784),a=n(2283),u=n(893),c=n(1080),l=n(2816)},8229:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsFromEnv=void 0,t.resolveDefaultFetch=s,t.createConfig=function(e){var t;let n=Object.assign(Object.assign(Object.assign({},a),e),{fetch:null!==(t=e.fetch)&&void 0!==t?t:s()});e.proxyUrl&&(n=Object.assign(Object.assign({},n),{requestMiddleware:(0,r.withMiddleware)(n.requestMiddleware,(0,r.withProxy)({targetUrl:e.proxyUrl}))}));let{credentials:i,suppressLocalCredentialsWarning:u}=n,c="function"==typeof i?i():i;return(0,o.isBrowser)()&&c&&!u&&console.warn("The fal credentials are exposed in the browser's environment. That's not recommended for production use cases."),n},t.getRestApiUrl=function(){return"https://rest.alpha.fal.ai"};let r=n(5253),i=n(893),o=n(5703);function s(){if("undefined"==typeof fetch)throw Error("Your environment does not support fetch. Please provide your own fetch implementation.");return fetch}t.credentialsFromEnv=()=>"undefined"!=typeof process&&process.env&&(void 0!==process.env.FAL_KEY||void 0!==process.env.FAL_KEY_ID&&void 0!==process.env.FAL_KEY_SECRET)?void 0!==process.env.FAL_KEY?process.env.FAL_KEY:process.env.FAL_KEY_ID?`${process.env.FAL_KEY_ID}:${process.env.FAL_KEY_SECRET}`:void 0:void 0;let a={credentials:t.credentialsFromEnv,suppressLocalCredentialsWarning:!1,requestMiddleware:e=>Promise.resolve(e),responseHandler:i.defaultResponseHandler}},6605:function(e,t,n){let r;var i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.fal=t.parseEndpointId=t.ValidationError=t.ApiError=t.withProxy=t.withMiddleware=t.createFalClient=void 0;let s=n(8926);var a=n(8926);Object.defineProperty(t,"createFalClient",{enumerable:!0,get:function(){return a.createFalClient}});var u=n(5253);Object.defineProperty(t,"withMiddleware",{enumerable:!0,get:function(){return u.withMiddleware}}),Object.defineProperty(t,"withProxy",{enumerable:!0,get:function(){return u.withProxy}});var c=n(893);Object.defineProperty(t,"ApiError",{enumerable:!0,get:function(){return c.ApiError}}),Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return c.ValidationError}}),o(n(6264),t);var l=n(4138);Object.defineProperty(t,"parseEndpointId",{enumerable:!0,get:function(){return l.parseEndpointId}}),t.fal=(r=(0,s.createFalClient)(),{config(e){r=(0,s.createFalClient)(e)},get queue(){return r.queue},get realtime(){return r.realtime},get storage(){return r.storage},get streaming(){return r.streaming},run:(e,t)=>r.run(e,t),subscribe:(e,t)=>r.subscribe(e,t),stream:(e,t)=>r.stream(e,t)})},5253:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TARGET_URL_HEADER=void 0,t.withMiddleware=function(...e){let t=e=>"function"==typeof e;return r=>n(this,void 0,void 0,function*(){let n=Object.assign({},r);for(let r of e.filter(t))n=yield r(n);return n})},t.withProxy=function(e){return e=>Promise.resolve(e)},t.TARGET_URL_HEADER="x-fal-target-url"},2900:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};Object.defineProperty(t,"__esModule",{value:!0}),t.createQueueClient=void 0;let o=n(2283),s=n(893),a=n(2816),u=n(4138);t.createQueueClient=({config:e,storage:t})=>{let n={submit(n,s){return r(this,void 0,void 0,function*(){let{webhookUrl:r,priority:a}=s,u=i(s,["webhookUrl","priority"]),c=s.input?yield t.transformInput(s.input):void 0;return(0,o.dispatchRequest)({method:s.method,targetUrl:(0,o.buildUrl)(n,Object.assign(Object.assign({},u),{subdomain:"queue",query:r?{fal_webhook:r}:void 0})),headers:{"x-fal-queue-priority":null!=a?a:"normal"},input:c,config:e,options:{signal:s.abortSignal}})})},status(t,n){return r(this,arguments,void 0,function*(t,{requestId:n,logs:r=!1,abortSignal:i}){let s=(0,u.parseEndpointId)(t),a=s.namespace?`${s.namespace}/`:"";return(0,o.dispatchRequest)({method:"get",targetUrl:(0,o.buildUrl)(`${a}${s.owner}/${s.alias}`,{subdomain:"queue",query:{logs:r?"1":"0"},path:`/requests/${n}/status`}),config:e,options:{signal:i}})})},streamStatus(t,n){return r(this,arguments,void 0,function*(t,{requestId:n,logs:r=!1,connectionMode:i}){let s=(0,u.parseEndpointId)(t),c=s.namespace?`${s.namespace}/`:"",l={logs:r?"1":"0"},h=(0,o.buildUrl)(`${c}${s.owner}/${s.alias}`,{subdomain:"queue",path:`/requests/${n}/status/stream`,query:l});return new a.FalStream(t,e,{url:h,method:"get",connectionMode:i,queryParams:l})})},subscribeToStatus(e,t){return r(this,void 0,void 0,function*(){let i;let o=t.requestId,s=t.timeout,a=()=>{};if("streaming"===t.mode){let r=yield n.streamStatus(e,{requestId:o,logs:t.logs,connectionMode:"connectionMode"in t?t.connectionMode:void 0}),u=[];s&&(i=setTimeout(()=>{throw r.abort(),n.cancel(e,{requestId:o}).catch(a),Error(`Client timed out waiting for the request to complete after ${s}ms`)},s)),r.on("data",e=>{t.onQueueUpdate&&("logs"in e&&Array.isArray(e.logs)&&e.logs.length>0&&u.push(...e.logs),t.onQueueUpdate("logs"in e?Object.assign(Object.assign({},e),{logs:u}):e))});let c=yield r.done();return i&&clearTimeout(i),c}return new Promise((u,c)=>{var l;let h;let d="pollInterval"in t&&"number"==typeof t.pollInterval&&null!==(l=t.pollInterval)&&void 0!==l?l:500,f=()=>{i&&clearTimeout(i),h&&clearTimeout(h)};s&&(i=setTimeout(()=>{f(),n.cancel(e,{requestId:o}).catch(a),c(Error(`Client timed out waiting for the request to complete after ${s}ms`))},s));let p=()=>r(this,void 0,void 0,function*(){var r;try{let i=yield n.status(e,{requestId:o,logs:null!==(r=t.logs)&&void 0!==r&&r,abortSignal:t.abortSignal});if(t.onQueueUpdate&&t.onQueueUpdate(i),"COMPLETED"===i.status){f(),u(i);return}h=setTimeout(p,d)}catch(e){f(),c(e)}});p().catch(c)})})},result(t,n){return r(this,arguments,void 0,function*(t,{requestId:n,abortSignal:r}){let i=(0,u.parseEndpointId)(t),a=i.namespace?`${i.namespace}/`:"";return(0,o.dispatchRequest)({method:"get",targetUrl:(0,o.buildUrl)(`${a}${i.owner}/${i.alias}`,{subdomain:"queue",path:`/requests/${n}`}),config:Object.assign(Object.assign({},e),{responseHandler:s.resultResponseHandler}),options:{signal:r}})})},cancel(t,n){return r(this,arguments,void 0,function*(t,{requestId:n,abortSignal:r}){let i=(0,u.parseEndpointId)(t),s=i.namespace?`${i.namespace}/`:"";yield(0,o.dispatchRequest)({method:"put",targetUrl:(0,o.buildUrl)(`${s}${i.owner}/${i.alias}`,{subdomain:"queue",path:`/requests/${n}/cancel`}),config:e,options:{signal:r}})})}};return n}},5784:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRealtimeClient=function({config:e}){return{connect(t,n){let c;let{clientOnly:l=(0,u.isReact)()&&!(0,a.isBrowser)(),connectionKey:h=crypto.randomUUID(),maxBuffering:w,throttleInterval:b=128}=n;if(l&&!(0,a.isBrowser)())return v;y.set(h,{onError:n.onError,onResult:n.onResult});let x=()=>y.get(h),U=function(e,t,n){if(!p.has(e)){let r=(0,i.interpret)(d,n);p.set(e,Object.assign(Object.assign({},r),{throttledSend:t>0?(0,u.throttle)(r.send,t,!0):r.send}))}return p.get(e)}(h,b,({context:n,machine:i,send:a})=>{let{enqueuedMessage:l,token:h}=n;if("active"===i.current&&l&&a({type:"send",message:l}),"authRequired"===i.current&&void 0===h&&c!==i.current&&(a({type:"initiateAuth"}),(0,o.getTemporaryAuthToken)(t,e).then(e=>{a({type:"authenticated",token:e}),setTimeout(()=>{a({type:"expireToken"})},Math.round(900*o.TOKEN_EXPIRATION_SECONDS))}).catch(e=>{a({type:"unauthorized",error:e})})),"connecting"===i.current&&c!==i.current&&void 0!==h){let e=new WebSocket(function(e,{token:t,maxBuffering:n}){if(void 0!==n&&(n<1||n>60))throw Error("The `maxBuffering` must be between 1 and 60 (inclusive)");let r=new URLSearchParams({fal_jwt_token:t});void 0!==n&&r.set("max_buffering",n.toFixed(0));let i=(0,u.ensureEndpointIdFormat)(e);return`wss://fal.run/${i}/realtime?${r.toString()}`}(t,{token:h,maxBuffering:w}));e.onopen=()=>{a({type:"connected",websocket:e})},e.onclose=e=>{if(e.code!==f.NORMAL_CLOSURE){let{onError:t=g}=x();t(new s.ApiError({message:`Error closing the connection: ${e.reason}`,status:e.code}))}a({type:"connectionClosed",code:e.code})},e.onerror=e=>{let{onError:t=g}=x();t(new s.ApiError({message:"Unknown error",status:500}))},e.onmessage=e=>{let{onResult:t}=x();if(e.data instanceof ArrayBuffer){t((0,r.decode)(new Uint8Array(e.data)));return}if(e.data instanceof Uint8Array){t((0,r.decode)(e.data));return}if(e.data instanceof Blob){e.data.arrayBuffer().then(e=>{t((0,r.decode)(new Uint8Array(e)))});return}let n=JSON.parse(e.data);if("error"===n.status&&"Unauthorized"===n.error){a({type:"unauthorized",error:Error("Unauthorized")});return}if("error"!==n.status&&"x-fal-message"!==n.type&&!m(n)){t(n);return}if(m(n)){if("TIMEOUT"===n.error)return;let{onError:e=g}=x();e(new s.ApiError({message:`${n.error}: ${n.reason}`,status:400,body:n}));return}}}c=i.current});return{send:e=>{U.throttledSend({type:"send",message:e})},close:()=>{U.send({type:"close"})}}}}};let r=n(4851),i=n(8008),o=n(5122),s=n(893),a=n(5703),u=n(4138);function c(e,t){return Object.assign(Object.assign({},e),{enqueuedMessage:t.message})}function l(e){return e.websocket&&e.websocket.readyState===WebSocket.OPEN&&e.websocket.close(),Object.assign(Object.assign({},e),{websocket:void 0})}function h(e){return Object.assign(Object.assign({},e),{token:void 0})}let d=(0,i.createMachine)("idle",{idle:(0,i.state)((0,i.transition)("send","connecting",(0,i.reduce)(c)),(0,i.transition)("expireToken","idle",(0,i.reduce)(h)),(0,i.transition)("close","idle",(0,i.reduce)(l))),connecting:(0,i.state)((0,i.transition)("connecting","connecting"),(0,i.transition)("connected","active",(0,i.reduce)(function(e,t){return Object.assign(Object.assign({},e),{websocket:t.websocket})})),(0,i.transition)("connectionClosed","idle",(0,i.reduce)(l)),(0,i.transition)("send","connecting",(0,i.reduce)(c)),(0,i.transition)("close","idle",(0,i.reduce)(l)),(0,i.immediate)("authRequired",(0,i.guard)(function(e){return!(void 0!==e.token)}))),authRequired:(0,i.state)((0,i.transition)("initiateAuth","authInProgress"),(0,i.transition)("send","authRequired",(0,i.reduce)(c)),(0,i.transition)("close","idle",(0,i.reduce)(l))),authInProgress:(0,i.state)((0,i.transition)("authenticated","connecting",(0,i.reduce)(function(e,t){return Object.assign(Object.assign({},e),{token:t.token})})),(0,i.transition)("unauthorized","idle",(0,i.reduce)(h),(0,i.reduce)(l)),(0,i.transition)("send","authInProgress",(0,i.reduce)(c)),(0,i.transition)("close","idle",(0,i.reduce)(l))),active:(0,i.state)((0,i.transition)("send","active",(0,i.reduce)(function(e,t){return e.websocket&&e.websocket.readyState===WebSocket.OPEN?(t.message instanceof Uint8Array?e.websocket.send(t.message):e.websocket.send((0,r.encode)(t.message)),Object.assign(Object.assign({},e),{enqueuedMessage:void 0})):Object.assign(Object.assign({},e),{enqueuedMessage:t.message})})),(0,i.transition)("unauthorized","idle",(0,i.reduce)(h)),(0,i.transition)("connectionClosed","idle",(0,i.reduce)(l)),(0,i.transition)("close","idle",(0,i.reduce)(l))),failed:(0,i.state)((0,i.transition)("send","failed"),(0,i.transition)("close","idle",(0,i.reduce)(l)))},()=>({enqueuedMessage:void 0})),f={NORMAL_CLOSURE:1e3},p=new Map,y=new Map,g=()=>{},v={send:g,close:g};function m(e){return"x-fal-error"===e.type}},2283:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchRequest=function(e){return r(this,void 0,void 0,function*(){var t,n,r;let{targetUrl:s,input:u,config:c,options:l={}}=e,{credentials:h,requestMiddleware:d,responseHandler:f,fetch:p}=c,y=(0,o.isBrowser)()?{}:{"User-Agent":(0,o.getUserAgent)()},g="function"==typeof h?h():h,{method:v,url:m,headers:w}=yield d({method:(null!==(n=null!==(t=e.method)&&void 0!==t?t:l.method)&&void 0!==n?n:"post").toUpperCase(),url:s,headers:e.headers}),b=Object.assign(Object.assign(Object.assign(Object.assign({},g?{Authorization:`Key ${g}`}:{}),{Accept:"application/json","Content-Type":"application/json"}),y),null!=w?w:{}),{responseHandler:x}=l,U=i(l,["responseHandler"]),E=yield p(m,Object.assign(Object.assign(Object.assign(Object.assign({},U),{method:v,headers:Object.assign(Object.assign({},b),null!==(r=U.headers)&&void 0!==r?r:{})}),!a&&{mode:"cors"}),{signal:l.signal,body:"get"!==v.toLowerCase()&&u?JSON.stringify(u):void 0}));return yield(null!=x?x:f)(E)})},t.buildUrl=function(e,t={}){var n,r;let i=(null!==(n=t.method)&&void 0!==n?n:"post").toLowerCase(),o=(null!==(r=t.path)&&void 0!==r?r:"").replace(/^\//,"").replace(/\/{2,}/,"/"),a=t.input,u=Object.assign(Object.assign({},t.query||{}),"get"===i?a:{}),c=Object.keys(u).length>0?`?${new URLSearchParams(u).toString()}`:"";if((0,s.isValidUrl)(e)){let t=e.endsWith("/")?e:`${e}/`;return`${t}${o}${c}`}let l=(0,s.ensureEndpointIdFormat)(e),h=t.subdomain?`${t.subdomain}.`:"",d=`https://${h}fal.run/${l}/${o}`;return`${d.replace(/\/$/,"")}${c}`};let o=n(5703),s=n(4138),a="undefined"!=typeof navigator&&(null==navigator?void 0:navigator.userAgent)==="Cloudflare-Workers"},893:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.ValidationError=t.ApiError=void 0,t.defaultResponseHandler=o,t.resultResponseHandler=function(e){return n(this,void 0,void 0,function*(){return{data:yield o(e),requestId:e.headers.get("x-fal-request-id")||""}})};class r extends Error{constructor({message:e,status:t,body:n}){super(e),this.name="ApiError",this.status=t,this.body=n}}t.ApiError=r;class i extends r{constructor(e){super(e),this.name="ValidationError"}get fieldErrors(){return"string"==typeof this.body.detail?[{loc:["body"],msg:this.body.detail,type:"value_error"}]:this.body.detail||[]}getFieldErrors(e){return this.fieldErrors.filter(t=>t.loc[t.loc.length-1]===e)}}function o(e){return n(this,void 0,void 0,function*(){var t;let{status:n,statusText:o}=e,s=null!==(t=e.headers.get("Content-Type"))&&void 0!==t?t:"";if(!e.ok){if(s.includes("application/json")){let t=yield e.json();throw new(422===n?i:r)({message:t.message||o,status:n,body:t})}throw new r({message:`HTTP ${n}: ${o}`,status:n})}return s.includes("application/json")?e.json():s.includes("text/html")?e.text():s.includes("application/octet-stream")?e.arrayBuffer():e.text()})}t.ValidationError=i},5703:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=function(){return!1},t.getUserAgent=function(){if(null!==r)return r;let e=n(1286);return r=`${e.name}/${e.version}`};let r=null},1080:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.createStorageClient=function({config:e}){let t={upload:t=>r(this,void 0,void 0,function*(){if(t.size>94371840)return yield function(e,t){return r(this,void 0,void 0,function*(){let{fetch:n,responseHandler:s}=t,u=e.type||"application/octet-stream",{upload_url:c,file_url:l}=yield function(e,t,n){return r(this,void 0,void 0,function*(){let r=e.name||`${Date.now()}.${a(n)}`;return yield(0,o.dispatchRequest)({method:"POST",targetUrl:`${(0,i.getRestApiUrl)()}/storage/upload/initiate-multipart?storage_type=fal-cdn-v3`,input:{content_type:n,file_name:r},config:t})})}(e,t,u),h=Math.ceil(e.size/10485760),d=new URL(c),f=[];for(let n=0;n<h;n++){let i=10485760*n,o=Math.min(i+10485760,e.size),s=e.slice(i,o),a=n+1,u=`${d.origin}${d.pathname}/${a}${d.search}`;f.push((yield function e(t,n,i){return r(this,arguments,void 0,function*(t,n,r,i=3){if(0===i)throw Error("Part upload failed, retries exhausted");let{fetch:o,responseHandler:s}=r;try{let e=yield o(t,{method:"PUT",body:n});return yield s(e)}catch(o){return yield e(t,n,r,i-1)}})}(u,s,t)))}let p=`${d.origin}${d.pathname}/complete${d.search}`,y=yield n(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parts:f.map(e=>({partNumber:e.partNumber,etag:e.etag}))})});return yield s(y),l})}(t,e);let n=t.type||"application/octet-stream",{fetch:s,responseHandler:u}=e,{upload_url:c,file_url:l}=yield function(e,t,n){return r(this,void 0,void 0,function*(){let r=e.name||`${Date.now()}.${a(n)}`;return yield(0,o.dispatchRequest)({method:"POST",targetUrl:`${(0,i.getRestApiUrl)()}/storage/upload/initiate?storage_type=fal-cdn-v3`,input:{content_type:n,file_name:r},config:t})})}(t,e,n),h=yield s(c,{method:"PUT",body:t,headers:{"Content-Type":t.type||"application/octet-stream"}});return yield u(h),l}),transformInput:e=>r(this,void 0,void 0,function*(){if(Array.isArray(e))return Promise.all(e.map(e=>t.transformInput(e)));if(e instanceof Blob)return yield t.upload(e);if((0,s.isPlainObject)(e)){let n=Object.entries(e).map(e=>r(this,[e],void 0,function*([e,n]){return[e,(yield t.transformInput(n))]}));return Object.fromEntries((yield Promise.all(n)))}return e})};return t};let i=n(8229),o=n(2283),s=n(4138);function a(e){var t;let[n,r]=e.split("/");return null!==(t=r.split(/[-;]/)[0])&&void 0!==t?t:"bin"}},2816:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__await||function(e){return this instanceof i?(this.v=e,this):new i(e)},o=this&&this.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,l)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(e,t){o[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||u(e,t)})},t&&(r[e]=t(r[e])))}function u(e,t){try{var n;(n=o[e](t)).value instanceof i?Promise.resolve(n.value.v).then(c,l):h(s[0][2],n)}catch(e){h(s[0][3],e)}}function c(e){u("next",e)}function l(e){u("throw",e)}function h(e,t){e(t),s.shift(),s.length&&u(s[0][0],s[0][1])}};Object.defineProperty(t,"__esModule",{value:!0}),t.FalStream=void 0,t.createStreamingClient=function({config:e,storage:t}){return{stream(n,i){return r(this,void 0,void 0,function*(){let r=i.input?yield t.transformInput(i.input):void 0;return new h(n,e,Object.assign(Object.assign({},i),{input:r}))})}}};let s=n(5538),a=n(5122),u=n(2283),c=n(893),l="text/event-stream";class h{constructor(e,t,n){var i;this.listeners=new Map,this.buffer=[],this.currentData=void 0,this.lastEventTimestamp=0,this.streamClosed=!1,this.abortController=new AbortController,this.start=()=>r(this,void 0,void 0,function*(){var e,t;let{endpointId:n,options:r}=this,{input:i,method:o="post",connectionMode:s="server"}=r;try{if("client"===s){let t=yield(0,a.getTemporaryAuthToken)(n,this.config),{fetch:s}=this.config,u=new URL(this.url);u.searchParams.set("fal_jwt_token",t);let c=yield s(u.toString(),{method:o.toUpperCase(),headers:{accept:null!==(e=r.accept)&&void 0!==e?e:l,"content-type":"application/json"},body:i&&"get"!==o?JSON.stringify(i):void 0,signal:this.abortController.signal});return yield this.handleResponse(c)}return yield(0,u.dispatchRequest)({method:o.toUpperCase(),targetUrl:this.url,input:i,config:this.config,options:{headers:{accept:null!==(t=r.accept)&&void 0!==t?t:l},responseHandler:this.handleResponse,signal:this.abortController.signal}})}catch(e){this.handleError(e)}}),this.handleResponse=e=>r(this,void 0,void 0,function*(){var t,n;if(!e.ok){try{yield(0,c.defaultResponseHandler)(e)}catch(e){this.emit("error",e)}return}let i=e.body;if(!i){this.emit("error",new c.ApiError({message:"Response body is empty.",status:400,body:void 0}));return}if(!(null!==(t=e.headers.get("content-type"))&&void 0!==t?t:"").startsWith(l)){let e=i.getReader(),t=()=>{e.read().then(({done:e,value:n})=>{if(e){this.emit("done",this.currentData);return}this.currentData=n,this.emit("data",n),t()})};t();return}let o=new TextDecoder("utf-8"),a=e.body.getReader(),u=(0,s.createParser)(e=>{if("event"===e.type){let t=e.data;try{let e=JSON.parse(t);this.buffer.push(e),this.currentData=e,this.emit("data",e),this.emit("message",e)}catch(e){this.emit("error",e)}}}),h=null!==(n=this.options.timeout)&&void 0!==n?n:15e3,d=()=>r(this,void 0,void 0,function*(){let{value:e,done:t}=yield a.read();this.lastEventTimestamp=Date.now(),u.feed(o.decode(e)),Date.now()-this.lastEventTimestamp>h&&this.emit("error",new c.ApiError({message:`Event stream timed out after ${(h/1e3).toFixed(0)} seconds with no messages.`,status:408})),t?this.emit("done",this.currentData):d().catch(this.handleError)});d().catch(this.handleError)}),this.handleError=e=>{var t;if("AbortError"===e.name||this.signal.aborted)return;let n=e instanceof c.ApiError?e:new c.ApiError({message:null!==(t=e.message)&&void 0!==t?t:"An unknown error occurred",status:500});this.emit("error",n)},this.on=(e,t)=>{var n;this.listeners.has(e)||this.listeners.set(e,[]),null===(n=this.listeners.get(e))||void 0===n||n.push(t)},this.emit=(e,t)=>{for(let n of this.listeners.get(e)||[])n(t)},this.done=()=>r(this,void 0,void 0,function*(){return this.donePromise}),this.abort=e=>{this.streamClosed||this.abortController.abort(e)},this.endpointId=e,this.config=t,this.url=null!==(i=n.url)&&void 0!==i?i:(0,u.buildUrl)(e,{path:"/stream",query:n.queryParams}),this.options=n,this.donePromise=new Promise((e,t)=>{this.streamClosed&&t(new c.ApiError({message:"Streaming connection is already closed.",status:400,body:void 0})),this.signal.addEventListener("abort",()=>{var t;e(null!==(t=this.currentData)&&void 0!==t?t:{})}),this.on("done",t=>{this.streamClosed=!0,e(t)}),this.on("error",e=>{this.streamClosed=!0,t(e)})}),n.signal&&n.signal.addEventListener("abort",()=>{this.abortController.abort()}),this.start().catch(this.handleError)}[Symbol.asyncIterator](){return o(this,arguments,function*(){let e=!0,t=()=>e=!1;for(this.on("error",t),this.on("done",t);e;){let e=this.buffer.shift();e&&(yield yield i(e)),yield i(new Promise(e=>setTimeout(e,16)))}})}get signal(){return this.abortController.signal}}t.FalStream=h},6264:(e,t)=>{function n(e){return e&&e.status&&e.response_url}Object.defineProperty(t,"__esModule",{value:!0}),t.isQueueStatus=n,t.isCompletedQueueStatus=function(e){return n(e)&&"COMPLETED"===e.status}},4138:(e,t)=>{let n;function r(e){if(e.split("/").length>1)return e;let[,t,n]=/^([0-9]+)-([a-zA-Z0-9-]+)$/.exec(e)||[];if(t&&n)return`${t}/${n}`;throw Error(`Invalid app id: ${e}. Must be in the format <appOwner>/<appId>`)}Object.defineProperty(t,"__esModule",{value:!0}),t.ensureEndpointIdFormat=r,t.parseEndpointId=function(e){let t=r(e).split("/");return i.includes(t[0])?{owner:t[1],alias:t[2],path:t.slice(3).join("/")||void 0,namespace:t[0]}:{owner:t[0],alias:t[1],path:t.slice(2).join("/")||void 0}},t.isValidUrl=function(e){try{let{host:t}=new URL(e);return/(fal\.(ai|run))$/.test(t)}catch(e){return!1}},t.throttle=function(e,t,n=!1){let r,i;return(...o)=>{!i&&n?(e(...o),i=Date.now()):(r&&clearTimeout(r),r=setTimeout(()=>{Date.now()-i>=t&&(e(...o),i=Date.now())},t-(Date.now()-i)))}},t.isReact=function(){if(void 0===n){let e=Error().stack;n=!!e&&(e.includes("node_modules/react-dom/")||e.includes("node_modules/next/"))}return n},t.isPlainObject=function(e){return!!e&&Object.getPrototypeOf(e)===Object.prototype};let i=["workflows","comfy"]},4851:(e,t,n)=>{n.r(t),n.d(t,{DataViewIndexOutOfBoundsError:()=>B,DecodeError:()=>u,Decoder:()=>R,EXT_TIMESTAMP:()=>h,Encoder:()=>b,ExtData:()=>s,ExtensionCodec:()=>m,decode:()=>M,decodeArrayStream:()=>K,decodeAsync:()=>N,decodeMulti:()=>D,decodeMultiStream:()=>H,decodeStream:()=>W,decodeTimestampExtension:()=>g,decodeTimestampToTimeSpec:()=>y,encode:()=>x,encodeDateToTimeSpec:()=>f,encodeTimeSpecToTimestamp:()=>d,encodeTimestampExtension:()=>p});var r=new TextEncoder;function i(e,t,n){for(var r=t,i=r+n,o=[],s="";r<i;){var a=e[r++];if((128&a)==0)o.push(a);else if((224&a)==192){var u=63&e[r++];o.push((31&a)<<6|u)}else if((240&a)==224){var u=63&e[r++],c=63&e[r++];o.push((31&a)<<12|u<<6|c)}else if((248&a)==240){var u=63&e[r++],c=63&e[r++],l=(7&a)<<18|u<<12|c<<6|63&e[r++];l>65535&&(l-=65536,o.push(l>>>10&1023|55296),l=56320|1023&l),o.push(l)}else o.push(a);o.length>=4096&&(s+=String.fromCharCode.apply(String,o),o.length=0)}return o.length>0&&(s+=String.fromCharCode.apply(String,o)),s}var o=new TextDecoder,s=function(e,t){this.type=e,this.data=t},a=function(){var e=function(t,n){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,Object.create(t.prototype)),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:t.name}),r}return a(t,e),t}(Error);function c(e,t,n){e.setUint32(t,Math.floor(n/4294967296)),e.setUint32(t+4,n)}function l(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var h=-1;function d(e){var t=e.sec,n=e.nsec;if(t>=0&&n>=0&&t<=17179869183){if(0===n&&t<=4294967295){var r=new Uint8Array(4),i=new DataView(r.buffer);return i.setUint32(0,t),r}var o=t/4294967296,r=new Uint8Array(8),i=new DataView(r.buffer);return i.setUint32(0,n<<2|3&o),i.setUint32(4,4294967295&t),r}var r=new Uint8Array(12),i=new DataView(r.buffer);return i.setUint32(0,n),c(i,4,t),r}function f(e){var t=e.getTime(),n=Math.floor(t/1e3),r=(t-1e3*n)*1e6,i=Math.floor(r/1e9);return{sec:n+i,nsec:r-1e9*i}}function p(e){return e instanceof Date?d(f(e)):null}function y(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:var n=t.getUint32(0),r=0;return{sec:n,nsec:0};case 8:var i=t.getUint32(0),n=(3&i)*4294967296+t.getUint32(4),r=i>>>2;return{sec:n,nsec:r};case 12:var n=l(t,4),r=t.getUint32(0);return{sec:n,nsec:r};default:throw new u("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}function g(e){var t=y(e);return new Date(1e3*t.sec+t.nsec/1e6)}var v={type:-1,encode:p,decode:g},m=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(v)}return e.prototype.register=function(e){var t=e.type,n=e.encode,r=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=r;else{var i=1+t;this.builtInEncoders[i]=n,this.builtInDecoders[i]=r}},e.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++){var r=this.builtInEncoders[n];if(null!=r){var i=r(e,t);if(null!=i){var o=-1-n;return new s(o,i)}}}for(var n=0;n<this.encoders.length;n++){var r=this.encoders[n];if(null!=r){var i=r(e,t);if(null!=i){var o=n;return new s(o,i)}}}return e instanceof s?e:null},e.prototype.decode=function(e,t,n){var r=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return r?r(e,t,n):new s(t,e)},e.defaultCodec=new e,e}();function w(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var b=function(){function e(e){var t,n,r,i,o,s,a,u;this.extensionCodec=null!==(t=null==e?void 0:e.extensionCodec)&&void 0!==t?t:m.defaultCodec,this.context=null==e?void 0:e.context,this.useBigInt64=null!==(n=null==e?void 0:e.useBigInt64)&&void 0!==n&&n,this.maxDepth=null!==(r=null==e?void 0:e.maxDepth)&&void 0!==r?r:100,this.initialBufferSize=null!==(i=null==e?void 0:e.initialBufferSize)&&void 0!==i?i:2048,this.sortKeys=null!==(o=null==e?void 0:e.sortKeys)&&void 0!==o&&o,this.forceFloat32=null!==(s=null==e?void 0:e.forceFloat32)&&void 0!==s&&s,this.ignoreUndefined=null!==(a=null==e?void 0:e.ignoreUndefined)&&void 0!==a&&a,this.forceIntegerToFloat=null!==(u=null==e?void 0:e.forceIntegerToFloat)&&void 0!==u&&u,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),r=new DataView(t);n.set(this.bytes),this.view=r,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)},e.prototype.encodeNumberAsFloat=function(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.encodeBigInt64=function(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw Error("Too long string: ".concat(e," bytes in UTF-8"))},e.prototype.encodeString=function(e){var t,n,i,o=function(e){for(var t=e.length,n=0,r=0;r<t;){var i=e.charCodeAt(r++);if((4294967168&i)==0){n++;continue}if((4294965248&i)==0)n+=2;else{if(i>=55296&&i<=56319&&r<t){var o=e.charCodeAt(r);(64512&o)==56320&&(++r,i=((1023&i)<<10)+(1023&o)+65536)}(4294901760&i)==0?n+=3:n+=4}}return n}(e);this.ensureBufferSizeToWrite(5+o),this.writeStringHeader(o),t=e,n=this.bytes,i=this.pos,t.length>50?r.encodeInto(t,n.subarray(i)):function(e,t,n){for(var r=e.length,i=n,o=0;o<r;){var s=e.charCodeAt(o++);if((4294967168&s)==0){t[i++]=s;continue}if((4294965248&s)==0)t[i++]=s>>6&31|192;else{if(s>=55296&&s<=56319&&o<r){var a=e.charCodeAt(o);(64512&a)==56320&&(++o,s=((1023&s)<<10)+(1023&a)+65536)}(4294901760&s)==0?t[i++]=s>>12&15|224:(t[i++]=s>>18&7|240,t[i++]=s>>12&63|128),t[i++]=s>>6&63|128}t[i++]=63&s|128}}(t,n,i),this.pos+=o},e.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if("object"==typeof e)this.encodeMap(e,t);else throw Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)))},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<4294967296)this.writeU8(198),this.writeU32(t);else throw Error("Too large binary: ".concat(t));var n=w(e);this.writeU8a(n)},e.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw Error("Too large array: ".concat(n));for(var r=0;r<e.length;r++){var i=e[r];this.doEncode(i,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var n=0,r=0;r<t.length;r++)void 0!==e[t[r]]&&n++;return n},e.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var r=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(r<16)this.writeU8(128+r);else if(r<65536)this.writeU8(222),this.writeU16(r);else if(r<4294967296)this.writeU8(223),this.writeU32(r);else throw Error("Too large map object: ".concat(r));for(var i=0;i<n.length;i++){var o=n[i],s=e[o];this.ignoreUndefined&&void 0===s||(this.encodeString(o),this.doEncode(s,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<4294967296)this.writeU8(201),this.writeU32(t);else throw Error("Too large extension object: ".concat(t));this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){var t,n;this.ensureBufferSizeToWrite(8),t=this.view,n=this.pos,t.setUint32(n,e/4294967296),t.setUint32(n+4,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),c(this.view,this.pos,e),this.pos+=8},e.prototype.writeBigUint64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8},e.prototype.writeBigInt64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8},e}();function x(e,t){return new b(t).encodeSharedRef(e)}function U(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var E=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,n){var r=this.caches[n-1];e:for(var i=0;i<r.length;i++){for(var o=r[i],s=o.bytes,a=0;a<n;a++)if(s[a]!==e[t+a])continue e;return o.str}return null},e.prototype.store=function(e,t){var n=this.caches[e.length-1],r={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=r:n.push(r)},e.prototype.decode=function(e,t,n){var r=this.find(e,t,n);if(null!=r)return this.hit++,r;this.miss++;var o=i(e,t,n),s=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(s,o),o},e}(),S=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},O=function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}},_=function(e){return this instanceof _?(this.v=e,this):new _(e)},I=function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||a(e,t)})})}function a(e,t){try{var n;(n=i[e](t)).value instanceof _?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(e){l(o[0][3],e)}}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}},A="array",P="map_key",j=new DataView(new ArrayBuffer(0)),T=new Uint8Array(j.buffer);try{j.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}var B=RangeError,k=new B("Insufficient data"),C=new E,R=function(){function e(e){var t,n,r,i,o,s,a;this.totalPos=0,this.pos=0,this.view=j,this.bytes=T,this.headByte=-1,this.stack=[],this.extensionCodec=null!==(t=null==e?void 0:e.extensionCodec)&&void 0!==t?t:m.defaultCodec,this.context=null==e?void 0:e.context,this.useBigInt64=null!==(n=null==e?void 0:e.useBigInt64)&&void 0!==n&&n,this.maxStrLength=null!==(r=null==e?void 0:e.maxStrLength)&&void 0!==r?r:4294967295,this.maxBinLength=null!==(i=null==e?void 0:e.maxBinLength)&&void 0!==i?i:4294967295,this.maxArrayLength=null!==(o=null==e?void 0:e.maxArrayLength)&&void 0!==o?o:4294967295,this.maxMapLength=null!==(s=null==e?void 0:e.maxMapLength)&&void 0!==s?s:4294967295,this.maxExtLength=null!==(a=null==e?void 0:e.maxExtLength)&&void 0!==a?a:4294967295,this.keyDecoder=(null==e?void 0:e.keyDecoder)!==void 0?e.keyDecoder:C}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=w(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=w(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),n=w(e),r=new Uint8Array(t.length+n.length);r.set(t),r.set(n,t.length),this.setBuffer(r)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,n=this.pos;return RangeError("Extra ".concat(t.byteLength-n," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return S(this,function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:if(!this.hasRemaining(1))return[3,3];return[4,this.doDecodeSync()];case 2:return t.sent(),[3,1];case 3:return[2]}})},e.prototype.decodeAsync=function(e){var t,n,r,i,o,s,a,u,c,l,h;return u=this,c=void 0,l=void 0,h=function(){var u,c,l,h,d,f,p;return S(this,function(y){switch(y.label){case 0:u=!1,y.label=1;case 1:y.trys.push([1,6,7,12]),t=!0,n=O(e),y.label=2;case 2:return[4,n.next()];case 3:if(i=(r=y.sent()).done)return[3,5];a=r.value,t=!1;try{if(l=a,u)throw this.createExtraByteError(this.totalPos);this.appendBuffer(l);try{c=this.doDecodeSync(),u=!0}catch(e){if(!(e instanceof B))throw e}this.totalPos+=this.pos}finally{t=!0}y.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return o={error:y.sent()},[3,12];case 7:if(y.trys.push([7,,10,11]),!(!t&&!i&&(s=n.return)))return[3,9];return[4,s.call(n)];case 8:y.sent(),y.label=9;case 9:return[3,11];case 10:if(o)throw o.error;return[7];case 11:return[7];case 12:if(u){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,c]}throw h=this,d=h.headByte,f=h.pos,p=h.totalPos,RangeError("Insufficient data in parsing ".concat(U(d)," at ").concat(p," (").concat(f," in the current buffer)"))}})},new(l||(l=Promise))(function(e,t){function n(e){try{i(h.next(e))}catch(e){t(e)}}function r(e){try{i(h.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):((i=t.value)instanceof l?i:new l(function(e){e(i)})).then(n,r)}i((h=h.apply(u,c||[])).next())})},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return I(this,arguments,function(){var n,r,i,o,s,a,u,c,l,h,d;return S(this,function(f){switch(f.label){case 0:n=t,r=-1,f.label=1;case 1:f.trys.push([1,15,16,21]),i=!0,o=O(e),f.label=2;case 2:return[4,_(o.next())];case 3:if(c=(s=f.sent()).done)return[3,14];d=s.value,i=!1,f.label=4;case 4:if(f.trys.push([4,,12,13]),a=d,t&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a),n&&(r=this.readArraySize(),n=!1,this.complete()),f.label=5;case 5:f.trys.push([5,10,,11]),f.label=6;case 6:return[4,_(this.doDecodeSync())];case 7:return[4,f.sent()];case 8:if(f.sent(),0==--r)return[3,9];return[3,6];case 9:return[3,11];case 10:if(!((u=f.sent())instanceof B))throw u;return[3,11];case 11:return this.totalPos+=this.pos,[3,13];case 12:return i=!0,[7];case 13:return[3,2];case 14:return[3,21];case 15:return l={error:f.sent()},[3,21];case 16:if(f.trys.push([16,,19,20]),!(!i&&!c&&(h=o.return)))return[3,18];return[4,_(h.call(o))];case 17:f.sent(),f.label=18;case 18:return[3,20];case 19:if(l)throw l.error;return[7];case 20:return[7];case 21:return[2]}})})},e.prototype.doDecodeSync=function(){t:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192){if(e<128)t=e;else if(e<144){var n=e-128;if(0!==n){this.pushMapState(n),this.complete();continue}t={}}else if(e<160){var n=e-144;if(0!==n){this.pushArrayState(n),this.complete();continue}t=[]}else{var r=e-160;t=this.decodeUtf8String(r,0)}}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===e){var r=this.lookU8();t=this.decodeUtf8String(r,1)}else if(218===e){var r=this.lookU16();t=this.decodeUtf8String(r,2)}else if(219===e){var r=this.lookU32();t=this.decodeUtf8String(r,4)}else if(220===e){var n=this.readU16();if(0!==n){this.pushArrayState(n),this.complete();continue}t=[]}else if(221===e){var n=this.readU32();if(0!==n){this.pushArrayState(n),this.complete();continue}t=[]}else if(222===e){var n=this.readU16();if(0!==n){this.pushMapState(n),this.complete();continue}t={}}else if(223===e){var n=this.readU32();if(0!==n){this.pushMapState(n),this.complete();continue}t={}}else if(196===e){var n=this.lookU8();t=this.decodeBinary(n,1)}else if(197===e){var n=this.lookU16();t=this.decodeBinary(n,2)}else if(198===e){var n=this.lookU32();t=this.decodeBinary(n,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){var n=this.lookU8();t=this.decodeExtension(n,1)}else if(200===e){var n=this.lookU16();t=this.decodeExtension(n,2)}else if(201===e){var n=this.lookU32();t=this.decodeExtension(n,4)}else throw new u("Unrecognized type byte: ".concat(U(e)));this.complete();for(var i=this.stack;i.length>0;){var o,s=i[i.length-1];if(s.type===A){if(s.array[s.position]=t,s.position++,s.position===s.size)i.pop(),t=s.array;else continue t}else if(s.type===P){if(!("string"==typeof(o=t)||"number"==typeof o))throw new u("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new u("The key __proto__ is not allowed");s.key=t,s.type="map_value";continue t}else if(s.map[s.key]=t,s.readCount++,s.readCount===s.size)i.pop(),t=s.map;else{s.key=null,s.type=P;continue t}}return t}},e.prototype.readHeadByte=function(){return -1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new u("Unrecognized array type byte: ".concat(U(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new u("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:P,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new u("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:A,size:e,array:Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){if(e>this.maxStrLength)throw new u("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw k;var n,r,s,a,c,l,h=this.pos+t;return l=this.stateIsMapKey()&&(null===(c=this.keyDecoder)||void 0===c?void 0:c.canBeCached(e))?this.keyDecoder.decode(this.bytes,h,e):(n=this.bytes,r=h,(s=e)>200?(a=n.subarray(r,r+s),o.decode(a)):i(n,r,s)),this.pos+=t+e,l},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&this.stack[this.stack.length-1].type===P},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new u("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw k;var n=this.pos+t,r=this.bytes.subarray(n,n+e);return this.pos+=t+e,r},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new u("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),r=this.decodeBinary(e,t+1);return this.extensionCodec.decode(r,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,n=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,n},e.prototype.readI64=function(){var e=l(this.view,this.pos);return this.pos+=8,e},e.prototype.readU64AsBigInt=function(){var e=this.view.getBigUint64(this.pos);return this.pos+=8,e},e.prototype.readI64AsBigInt=function(){var e=this.view.getBigInt64(this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}();function M(e,t){return new R(t).decode(e)}function D(e,t){return new R(t).decodeMulti(e)}var q=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},$=function(e){return this instanceof $?(this.v=e,this):new $(e)},L=function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||a(e,t)})})}function a(e,t){try{var n;(n=i[e](t)).value instanceof $?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(e){l(o[0][3],e)}}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}};function F(e){return null!=e[Symbol.asyncIterator]?e:function(e){return L(this,arguments,function(){var t,n,r,i;return q(this,function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,$(t.read())];case 3:if(r=(n=o.sent()).done,i=n.value,!r)return[3,5];return[4,$(void 0)];case 4:return[2,o.sent()];case 5:return function(e){if(null==e)throw Error("Assertion Failure: value must not be null nor undefined")}(i),[4,$(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}(e)}var z=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};function N(e,t){var n,r,i,o;return n=this,r=void 0,i=void 0,o=function(){var n;return z(this,function(r){return n=F(e),[2,new R(t).decodeAsync(n)]})},new(i||(i=Promise))(function(e,t){function s(e){try{u(o.next(e))}catch(e){t(e)}}function a(e){try{u(o.throw(e))}catch(e){t(e)}}function u(t){var n;t.done?e(t.value):((n=t.value)instanceof i?n:new i(function(e){e(n)})).then(s,a)}u((o=o.apply(n,r||[])).next())})}function K(e,t){var n=F(e);return new R(t).decodeArrayStream(n)}function H(e,t){var n=F(e);return new R(t).decodeStream(n)}var W=void 0},1286:e=>{e.exports=JSON.parse('{"name":"@fal-ai/client","description":"The fal.ai client for JavaScript and TypeScript","version":"1.2.1","license":"MIT","repository":{"type":"git","url":"https://github.com/fal-ai/fal-js.git","directory":"libs/client"},"keywords":["fal","client","ai","ml","typescript"],"exports":{".":"./src/index.js","./endpoints":"./src/types/endpoints.js"},"typesVersions":{"*":{"endpoints":["src/types/endpoints.d.ts"]}},"main":"./src/index.js","types":"./src/index.d.ts","dependencies":{"@msgpack/msgpack":"^3.0.0-beta2","eventsource-parser":"^1.1.2","robot3":"^0.4.1"},"engines":{"node":">=18.0.0"},"type":"commonjs"}')}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[638,206,840],()=>n(4123));module.exports=r})();